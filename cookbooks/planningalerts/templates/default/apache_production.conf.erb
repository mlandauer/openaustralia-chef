<VirtualHost *:80>
    ServerName <%= @node[:planningalerts][@stage][:virtual_host_name] %>
    DocumentRoot "<%= @node[:planningalerts][@stage][:html_root] %>"

    <Directory "<%= @node[:planningalerts][@stage][:html_root] %>">
        # TODO: Change these to be restrictive
        Options All MultiViews
        AllowOverride All
        Order allow,deny
        Allow from all
    </Directory>

    RackEnv development
    RackBaseURI /scrapers
    <Directory "<%= @node[:planningalerts][@stage][:html_root] %>/scrapers" >
      Options -MultiViews
    </Directory>
    
    ErrorLog "/var/log/<%= @node[:planningalerts][@stage][:name] %>-error_log"
    CustomLog /var/log/<%= @node[:planningalerts][@stage][:name] %>-access_log common

    #ErrorDocument 404 /404.php
</VirtualHost>

# Redirect (301) http://planningalerts.org.au/foo -> http://www.planningalerts.org.au/foo
<VirtualHost *:80>
    ServerName <%= @node[:planningalerts][:domain] %>
    RedirectMatch permanent ^/(.*) http://www.<%= @node[:planningalerts][:domain] %>/$1
</VirtualHost>
