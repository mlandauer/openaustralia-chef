<VirtualHost *:80>
    ServerName <%= @node[:planningalerts][:test][:virtual_host_name] %>
    DocumentRoot "<%= @node[:planningalerts][:test][:html_root] %>"

    <Directory "<%= @node[:planningalerts][:test][:html_root] %>">
        # TODO: Change these to be restrictive
        Options All MultiViews
        AllowOverride All
        Order allow,deny
        Allow from all

        AuthType Basic
        AuthName "Planning Alerts Staging Server"
        AuthUserFile <%= @node[:planningalerts][:test][:apache_password_file] %>
        Require user test    
    </Directory>

    RackEnv development
    RackBaseURI /scrapers
    <Directory "<%= @node[:planningalerts][:test][:html_root] %>/scrapers" >
      Options -MultiViews
      
      # Even though this directory is password protected - allow localhost
      # access to this directory without a password
      Order allow,deny
      # Trying hardcoded IP address of the server as a last resort
      Allow from 122.100.2.249
      Satisfy any
    </Directory>
    
    ErrorLog "/var/log/<%= @node[:planningalerts][:test][:name] %>-error_log"
    CustomLog /var/log/<%= @node[:planningalerts][:test][:name] %>-access_log common

    #ErrorDocument 404 /404.php
</VirtualHost>
